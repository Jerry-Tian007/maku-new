<template>
  <div class="back" align="left">
    <div
      class="color-background"
      style="position: absolute;width:100%;height:100%;"
    ></div>
    <div class="backgrond">
      <div
        class="button-background"
        style="height:30px;background:#00000000;display: flex;flex-direction: column;align-items: flex-end;padding-top:12px;"
      >
        <div style="display: flex;height:30px;align-items: center">
          <div
            class="clear-button"
            @click="switchLanguage()"
            style="pointer-events: none"
          >
            <i
              class="el-icon-connection"
              style="font-size: 18px;margin-right:4px;"
            />
            <span style="font-size: 16px;">搜索引擎: {{
                language === 'Chinese' ? 'Search' : language === 'English' ? 'Embedding' : 'm3e-base'
              }}</span>
          </div>
          <div
            class="clear-button-clear"
            @click="clearDialog()"
          >
            <i
              class="el-icon-delete"
              style="font-size: 18px;margin-right:4px;"
            />
            <span style="font-size: 16px;">清除对话</span>
          </div>
          <!--          <div
                         class="clear-button"
                         @click="drawerVal = true"
                     >
                       <i
                           class="el-icon-setting"
                           style="font-size: 16px;margin-right:4px;"
                       />
                       <span style="font-size: 20px;">参数设置</span>
                     </div>-->
        </div>
      </div>
      <div
        class="chat-background"
        style=""
      >
        <div :style="isMobile ? '' : 'flex:0.25;'" v-show="!isShow || isMobile"></div>
        <!--flex布局-聊天-->
        <div class="dialog-container">
          <div v-show="historyList.length<1">
<!--            <svg
              :class="uploading ? 'loading' : '' + ' empty-logo'"
              width="128"
              height="128"
              viewBox="0 0 41 41"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M37.5324 16.8707C37.9808 15.5241 38.1363 14.0974 37.9886 12.6859C37.8409 11.2744 37.3934 9.91076 36.676 8.68622C35.6126 6.83404 33.9882 5.3676 32.0373 4.4985C30.0864 3.62941 27.9098 3.40259 25.8215 3.85078C24.8796 2.7893 23.7219 1.94125 22.4257 1.36341C21.1295 0.785575 19.7249 0.491269 18.3058 0.500197C16.1708 0.495044 14.0893 1.16803 12.3614 2.42214C10.6335 3.67624 9.34853 5.44666 8.6917 7.47815C7.30085 7.76286 5.98686 8.3414 4.8377 9.17505C3.68854 10.0087 2.73073 11.0782 2.02839 12.312C0.956464 14.1591 0.498905 16.2988 0.721698 18.4228C0.944492 20.5467 1.83612 22.5449 3.268 24.1293C2.81966 25.4759 2.66413 26.9026 2.81182 28.3141C2.95951 29.7256 3.40701 31.0892 4.12437 32.3138C5.18791 34.1659 6.8123 35.6322 8.76321 36.5013C10.7141 37.3704 12.8907 37.5973 14.9789 37.1492C15.9208 38.2107 17.0786 39.0587 18.3747 39.6366C19.6709 40.2144 21.0755 40.5087 22.4946 40.4998C24.6307 40.5054 26.7133 39.8321 28.4418 38.5772C30.1704 37.3223 31.4556 35.5506 32.1119 33.5179C33.5027 33.2332 34.8167 32.6547 35.9659 31.821C37.115 30.9874 38.0728 29.9178 38.7752 28.684C39.8458 26.8371 40.3023 24.6979 40.0789 22.5748C39.8556 20.4517 38.9639 18.4544 37.5324 16.8707ZM22.4978 37.8849C20.7443 37.8874 19.0459 37.2733 17.6994 36.1501C17.7601 36.117 17.8666 36.0586 17.936 36.0161L25.9004 31.4156C26.1003 31.3019 26.2663 31.137 26.3813 30.9378C26.4964 30.7386 26.5563 30.5124 26.5549 30.2825V19.0542L29.9213 20.998C29.9389 21.0068 29.9541 21.0198 29.9656 21.0359C29.977 21.052 29.9842 21.0707 29.9867 21.0902V30.3889C29.9842 32.375 29.1946 34.2791 27.7909 35.6841C26.3872 37.0892 24.4838 37.8806 22.4978 37.8849ZM6.39227 31.0064C5.51397 29.4888 5.19742 27.7107 5.49804 25.9832C5.55718 26.0187 5.66048 26.0818 5.73461 26.1244L13.699 30.7248C13.8975 30.8408 14.1233 30.902 14.3532 30.902C14.583 30.902 14.8088 30.8408 15.0073 30.7248L24.731 25.1103V28.9979C24.7321 29.0177 24.7283 29.0376 24.7199 29.0556C24.7115 29.0736 24.6988 29.0893 24.6829 29.1012L16.6317 33.7497C14.9096 34.7416 12.8643 35.0097 10.9447 34.4954C9.02506 33.9811 7.38785 32.7263 6.39227 31.0064ZM4.29707 13.6194C5.17156 12.0998 6.55279 10.9364 8.19885 10.3327C8.19885 10.4013 8.19491 10.5228 8.19491 10.6071V19.808C8.19351 20.0378 8.25334 20.2638 8.36823 20.4629C8.48312 20.6619 8.64893 20.8267 8.84863 20.9404L18.5723 26.5542L15.206 28.4979C15.1894 28.5089 15.1703 28.5155 15.1505 28.5173C15.1307 28.5191 15.1107 28.516 15.0924 28.5082L7.04046 23.8557C5.32135 22.8601 4.06716 21.2235 3.55289 19.3046C3.03862 17.3858 3.30624 15.3413 4.29707 13.6194ZM31.955 20.0556L22.2312 14.4411L25.5976 12.4981C25.6142 12.4872 25.6333 12.4805 25.6531 12.4787C25.6729 12.4769 25.6928 12.4801 25.7111 12.4879L33.7631 17.1364C34.9967 17.849 36.0017 18.8982 36.6606 20.1613C37.3194 21.4244 37.6047 22.849 37.4832 24.2684C37.3617 25.6878 36.8382 27.0432 35.9743 28.1759C35.1103 29.3086 33.9415 30.1717 32.6047 30.6641C32.6047 30.5947 32.6047 30.4733 32.6047 30.3889V21.188C32.6066 20.9586 32.5474 20.7328 32.4332 20.5338C32.319 20.3348 32.154 20.1698 31.955 20.0556ZM35.3055 15.0128C35.2464 14.9765 35.1431 14.9142 35.069 14.8717L27.1045 10.2712C26.906 10.1554 26.6803 10.0943 26.4504 10.0943C26.2206 10.0943 25.9948 10.1554 25.7963 10.2712L16.0726 15.8858V11.9982C16.0715 11.9783 16.0753 11.9585 16.0837 11.9405C16.0921 11.9225 16.1048 11.9068 16.1207 11.8949L24.1719 7.25025C25.4053 6.53903 26.8158 6.19376 28.2383 6.25482C29.6608 6.31589 31.0364 6.78077 32.2044 7.59508C33.3723 8.40939 34.2842 9.53945 34.8334 10.8531C35.3826 12.1667 35.5464 13.6095 35.3055 15.0128ZM14.2424 21.9419L10.8752 19.9981C10.8576 19.9893 10.8423 19.9763 10.8309 19.9602C10.8195 19.9441 10.8122 19.9254 10.8098 19.9058V10.6071C10.8107 9.18295 11.2173 7.78848 11.9819 6.58696C12.7466 5.38544 13.8377 4.42659 15.1275 3.82264C16.4173 3.21869 17.8524 2.99464 19.2649 3.1767C20.6775 3.35876 22.0089 3.93941 23.1034 4.85067C23.0427 4.88379 22.937 4.94215 22.8668 4.98473L14.9024 9.58517C14.7025 9.69878 14.5366 9.86356 14.4215 10.0626C14.3065 10.2616 14.2466 10.4877 14.2479 10.7175L14.2424 21.9419ZM16.071 17.9991L20.4018 15.4978L24.7325 17.9975V22.9985L20.4018 25.4983L16.071 22.9985V17.9991Z"
                fill="#FFFFFFC0"
              ></path>
            </svg>
            <div v-show="uploading" class="loading-text">
              <div style="margin-bottom: 8px;">{{ uploadText }}</div>
              <el-progress style="width:40%;text-shadow: #FFF 0 0 2px;" :color="customColors" :percentage="uploadState"
                           :format="formatText"></el-progress>
            </div>-->
          </div>
          <div
            style="flex:1;width:100%;position:relative;overflow: auto; padding-top:20px;"
            id="chatBox"
            ref="historyContent"
          >
            <!--对话列表-->
            <div
              v-for="(item,index) in historyList"
              :key="index"
              style="padding:12px;"
              :align="item.role=='user' ? 'right' : 'left'"
            >
              <el-card
                class="card"
                align="left"
                :style="'background-color: #FFFFFF80;'+ (activeIndex==index ? 'border: 2px solid #2D9CDB;' : '')+ (item.role=='gpt' ? 'min-width:300px;' : '')"
              >
                <div
                  v-if="item.role=='gpt'"
                  slot="header"
                  class="card-header"
                >
                  <div>
                    <svg
                      width="24"
                      height="24"
                      viewBox="0 0 75 75"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <g clip-path="url(#clip0_54_2)">
                        <path
                          d="M35.8922 29.2828C36.4078 27.7359 38.5922 27.7359 39.1078 29.2828L42.1313 38.3625C42.7968 40.3584 43.918 42.1719 45.4062 43.6593C46.8943 45.1466 48.7084 46.2668 50.7047 46.9313L59.7797 49.9547C61.3266 50.4703 61.3266 52.6547 59.7797 53.1703L50.7 56.1938C48.7041 56.8592 46.8906 57.9805 45.4033 59.4686C43.9159 60.9568 42.7957 62.7709 42.1313 64.7672L39.1078 73.8422C38.9967 74.1809 38.7814 74.4759 38.4926 74.685C38.2039 74.8941 37.8565 75.0067 37.5 75.0067C37.1435 75.0067 36.7961 74.8941 36.5074 74.685C36.2187 74.4759 36.0034 74.1809 35.8922 73.8422L32.8688 64.7625C32.2038 62.7671 31.0832 60.9539 29.5959 59.4666C28.1086 57.9793 26.2955 56.8588 24.3 56.1938L15.2203 53.1703C14.8816 53.0591 14.5867 52.8438 14.3775 52.5551C14.1684 52.2664 14.0558 51.919 14.0558 51.5625C14.0558 51.206 14.1684 50.8586 14.3775 50.5699C14.5867 50.2812 14.8816 50.0659 15.2203 49.9547L24.3 46.9313C26.2955 46.2662 28.1086 45.1457 29.5959 43.6584C31.0832 42.1711 32.2038 40.3579 32.8688 38.3625L35.8922 29.2828ZM17.7844 5.38125C17.8516 5.17826 17.9811 5.00161 18.1544 4.8764C18.3278 4.7512 18.5362 4.68381 18.75 4.68381C18.9639 4.68381 19.1723 4.7512 19.3456 4.8764C19.519 5.00161 19.6484 5.17826 19.7157 5.38125L21.5297 10.8281C22.3407 13.2563 24.2438 15.1594 26.6719 15.9703L32.1188 17.7844C32.3218 17.8516 32.4984 17.9811 32.6236 18.1544C32.7488 18.3278 32.8162 18.5362 32.8162 18.75C32.8162 18.9638 32.7488 19.1722 32.6236 19.3456C32.4984 19.5189 32.3218 19.6484 32.1188 19.7156L26.6719 21.5297C25.4744 21.9287 24.3862 22.6011 23.4937 23.4936C22.6011 24.3862 21.9287 25.4743 21.5297 26.6719L19.7157 32.1188C19.6484 32.3217 19.519 32.4984 19.3456 32.6236C19.1723 32.7488 18.9639 32.8162 18.75 32.8162C18.5362 32.8162 18.3278 32.7488 18.1544 32.6236C17.9811 32.4984 17.8516 32.3217 17.7844 32.1188L15.9703 26.6719C15.5714 25.4743 14.8989 24.3862 14.0064 23.4936C13.1138 22.6011 12.0257 21.9287 10.8282 21.5297L5.38128 19.7156C5.17828 19.6484 5.00163 19.5189 4.87643 19.3456C4.75123 19.1722 4.68384 18.9638 4.68384 18.75C4.68384 18.5362 4.75123 18.3278 4.87643 18.1544C5.00163 17.9811 5.17828 17.8516 5.38128 17.7844L10.8282 15.9703C12.0257 15.5713 13.1138 14.8989 14.0064 14.0064C14.8989 13.1138 15.5714 12.0257 15.9703 10.8281L17.7844 5.38125ZM50.9203 0.464063C50.9666 0.330592 51.0533 0.214856 51.1684 0.132945C51.2835 0.0510342 51.4213 0.00701904 51.5625 0.00701904C51.7038 0.00701904 51.8415 0.0510342 51.9566 0.132945C52.0717 0.214856 52.1584 0.330592 52.2047 0.464063L53.4141 4.09219C53.9532 5.71406 55.2235 6.98438 56.8453 7.52344L60.4735 8.73281C60.6069 8.77909 60.7227 8.8658 60.8046 8.98089C60.8865 9.09598 60.9305 9.23374 60.9305 9.375C60.9305 9.51626 60.8865 9.65402 60.8046 9.76911C60.7227 9.8842 60.6069 9.97091 60.4735 10.0172L56.8453 11.2266C56.0461 11.4925 55.3198 11.941 54.7242 12.5366C54.1285 13.1323 53.68 13.8585 53.4141 14.6578L52.2047 18.2859C52.1584 18.4194 52.0717 18.5351 51.9566 18.6171C51.8415 18.699 51.7038 18.743 51.5625 18.743C51.4213 18.743 51.2835 18.699 51.1684 18.6171C51.0533 18.5351 50.9666 18.4194 50.9203 18.2859L49.711 14.6578C49.4451 13.8585 48.9965 13.1323 48.4009 12.5366C47.8053 11.941 47.079 11.4925 46.2797 11.2266L42.6563 10.0172C42.5228 9.97091 42.4071 9.8842 42.3252 9.76911C42.2432 9.65402 42.1992 9.51626 42.1992 9.375C42.1992 9.23374 42.2432 9.09598 42.3252 8.98089C42.4071 8.8658 42.5228 8.77909 42.6563 8.73281L46.2844 7.52344C47.9063 6.98438 49.1766 5.71406 49.7157 4.09219L50.9203 0.46875V0.464063Z"
                          fill="#2D9CDB"
                        />
                      </g>
                      <defs>
                        <clipPath id="clip0_54_2">
                          <rect
                            width="75"
                            height="75"
                            fill="white"
                          />
                        </clipPath>
                      </defs>
                    </svg>
                  </div>
                  <div style="display: flex;">
                    <div
                      class="icons"
                      style="margin-right: 10px;"
                      v-if="item.text !== '' && !item.isError"
                    >
                      <i
                        class="el-icon-s-opportunity"
                        @click="showProcess(item,index)"
                      />
                    </div>
                    <div
                      class="icons"
                      v-if="item.text !== '' && !item.isError"
                    >
                      <i
                        class="el-icon-news"
                        @click="changeIframeShowStatus(item,index)"
                      />
                    </div>
                  </div>
                </div>

                <!--文本内容-->
                <div class="card-text" v-if="!item.text">
                  {{ item.isError ? item.errorText : waitingText }}
                  <div style="margin-top: 16px;">
                    <el-button v-if="item.isError" style="margin-left: 6px;font-size:16px;" type="primary" size="small"
                               @click="retrySend(item,index)">
                      重试
                    </el-button>
                  </div>
                </div>

                <div
                  v-else-if="item.role=='user'"
                  style="white-space: pre-wrap;">
                  {{ item.text }}
                </div>
                <div
                  v-else
                  style="white-space: pre-wrap;line-height: 1.5em;">
                  <span v-for="(data,index2) in item.answers" :key="index2">
                    <span>{{ data.text }}</span>
                    <span
                      v-for="file in data.pdf"
                      :key="file"
                      @click="openFile(item,item.citation.find(item => item.name === file).url,item.citation.find(item => item.name === file).page,item.citation.find(item => item.name === file).originalFileName,index)"
                      class="index-span">
                      {{ item.citation.findIndex(item => item.name === file) + 1 }}
                    </span>
                  </span>
                </div>

                <!--文本内容
                <div class="card-text">
                  {{ item.isError ? item.errorText : '' || item.text || waitingText }}
                </div>-->
                <!--仅gpt回答时显示文件和后续问题-->
                <div
                  v-if="item.role=='gpt' && item.text != '' && !item.isError && !item.hasNoFiles"
                  style="padding-top:8px;"
                >
                  <div class="file-tag-container">
                    <span style="font-weight:600;font-size:14px;">文件：</span>
                    <span
                      v-for="(file,index2) in item.citation"
                      :key="index2">
                    <el-tag
                      @click="openFile(item,file.url,file.page,file.originalFileName,index)"
                      size="small"
                      style="margin: 0px 5px;margin-bottom:6px;cursor: pointer;font-size:14px;"
                      v-if="file.url != ''"
                    >
                      {{ index2 + 1 + '. ' + file.originalFileName }}
                    </el-tag>
                    </span>
                  </div>
                  <!--<div class="question-tag-container">
                    <span style="font-weight:600;font-size:14px;">后续问题：</span>
                    <el-tag
                        v-for="(follow,index) in item.follow"
                        :key="index"
                        @click="setFollowQuestion(follow)"
                        size="small"
                        style="margin: 0px 5px;margin-top:6px;cursor: pointer;"
                        type="info"
                    >
                  <span
                      style="font-style: italic;color: #606266;">{{ follow }}</span>
                    </el-tag>
                  </div>-->
                </div>
              </el-card>
            </div>
          </div>

          <!--按钮条 迁移至此，后期继续-->
          <div class="button-bar" v-if="false">
            <div
              v-for="(item,index) in buttonBar"
              :key="index"
              class="button-box"
              @click="item.click()"
            >
              <i :class="item.icon"/>
              <span style="margin-left: 4px;">{{ item.label }}</span>
            </div>
          </div>
          <!--输入栏-->
          <div
            class="input-bar"
            align="center"
          >
            <div style="display: flex;align-items: center;">
              <svg style="margin-left: 12px;opacity: 0.5;" width="30px" height="30px" viewBox="0 0 30 30" version="1.1"
                   xmlns="http://www.w3.org/2000/svg"
                   xmlns:xlink="http://www.w3.org/1999/xlink">
                <defs>
                  <linearGradient x1="0%" y1="1.15836768e-13%" x2="98.6230131%" y2="35.6700359%" id="linearGradient-1">
                    <stop stop-color="#504AF4" offset="0%"></stop>
                    <stop stop-color="#3E71FB" offset="100%"></stop>
                  </linearGradient>
                  <linearGradient x1="0%" y1="1.15836768e-13%" x2="98.6230131%" y2="35.6700359%" id="linearGradient-2">
                    <stop stop-color="#FFFFFF" offset="0%"></stop>
                    <stop stop-color="#FFFFFF" offset="100%"></stop>
                  </linearGradient>
                  <linearGradient x1="0%" y1="21.875%" x2="97.8602562%" y2="43.7901173%" id="linearGradient-3">
                    <stop stop-color="#504AF4" offset="0%"></stop>
                    <stop stop-color="#3E71FB" offset="100%"></stop>
                  </linearGradient>
                  <linearGradient x1="0%" y1="21.875%" x2="97.8602562%" y2="43.7901173%" id="linearGradient-4">
                    <stop stop-color="#FFFFFF" offset="0%"></stop>
                    <stop stop-color="#FFFFFF" offset="100%"></stop>
                  </linearGradient>
                  <linearGradient x1="0%" y1="42.8499969%" x2="13.2665094%" y2="102.449997%" id="linearGradient-5">
                    <stop stop-color="#504AF4" offset="0%"></stop>
                    <stop stop-color="#3E71FB" offset="100%"></stop>
                  </linearGradient>
                  <linearGradient x1="0%" y1="42.8499969%" x2="13.2665094%" y2="102.449997%" id="linearGradient-6">
                    <stop stop-color="#FFFFFF" offset="0%"></stop>
                    <stop stop-color="#FFFFFF" offset="100%"></stop>
                  </linearGradient>
                  <linearGradient x1="0%" y1="37.5%" x2="88.034188%" y2="58.1802252%" id="linearGradient-7">
                    <stop stop-color="#504AF4" offset="0%"></stop>
                    <stop stop-color="#3E71FB" offset="100%"></stop>
                  </linearGradient>
                  <linearGradient x1="0%" y1="37.5%" x2="88.034188%" y2="58.1802252%" id="linearGradient-8">
                    <stop stop-color="#FFFFFF" offset="0%"></stop>
                    <stop stop-color="#FFFFFF" offset="100%"></stop>
                  </linearGradient>
                  <linearGradient x1="28.95%" y1="33.4%" x2="70.45%" y2="45.3%" id="linearGradient-9">
                    <stop stop-color="#504AF4" offset="0%"></stop>
                    <stop stop-color="#3E71FB" offset="100%"></stop>
                  </linearGradient>
                  <linearGradient x1="28.95%" y1="33.4%" x2="70.45%" y2="45.3%" id="linearGradient-10">
                    <stop stop-color="#FFFFFF" offset="0%"></stop>
                    <stop stop-color="#FFFFFF" offset="100%"></stop>
                  </linearGradient>
                  <linearGradient x1="46.875%" y1="0%" x2="53.5296412%" y2="0.833942941%" id="linearGradient-11">
                    <stop stop-color="#504AF4" offset="0%"></stop>
                    <stop stop-color="#3E71FB" offset="100%"></stop>
                  </linearGradient>
                  <linearGradient x1="46.875%" y1="0%" x2="53.5296412%" y2="0.833942941%" id="linearGradient-12">
                    <stop stop-color="#FFFFFF" offset="0%"></stop>
                    <stop stop-color="#FFFFFF" offset="100%"></stop>
                  </linearGradient>
                  <linearGradient x1="6.12792912e-15%" y1="19.1323567%" x2="98.1893068%" y2="42.2902692%"
                                  id="linearGradient-13">
                    <stop stop-color="#504AF4" offset="0%"></stop>
                    <stop stop-color="#3485FF" offset="100%"></stop>
                  </linearGradient>
                  <linearGradient x1="6.12792912e-15%" y1="19.1323567%" x2="98.1893068%" y2="42.2902692%"
                                  id="linearGradient-14">
                    <stop stop-color="#FFFFFF" offset="0%"></stop>
                    <stop stop-color="#FFFFFF" offset="100%"></stop>
                  </linearGradient>
                </defs>
                <g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                  <g id="ChatGLM对话页" transform="translate(-618.000000, -332.000000)">
                    <g id="编组-22" transform="translate(603.000000, 225.000000)">
                      <g id="编组-20" transform="translate(0.000000, 97.000000)">
                        <g id="编组-4" transform="translate(15.000000, 10.000000)">
                          <rect id="矩形备份" fill="#3E6EFA" x="0" y="0" width="30" height="30" rx="8"></rect>
                          <g id="logo.ae7cdb36" transform="translate(5.000000, 6.000000)">
                            <path
                              d="M12.6960384,14 C12.9276523,14.3967094 13.0329567,14.8896352 12.9909569,15.3805021 C12.3482552,15.6833719 11.6801971,15.8912421 11,16 C11.9309971,15.7430714 12.6220518,14.9533746 12.6955246,14 L12.6960384,14 Z"
                              id="路径" fill="url(#linearGradient-2)" fill-rule="nonzero"></path>
                            <path
                              d="M17,12.5345376 C16.9947167,12.5398144 16.99049,12.5487849 16.985735,12.553534 C16.5951215,13.1057784 16.1400135,13.6095683 15.6300357,14.0542496 C15.1513671,14.4753364 14.1612733,15.0526159 14.2130498,14.9961544 C14.2225598,14.9866562 14.606657,14.6267799 14.7345133,14.4473695 C14.820103,14.3238929 14.8908995,14.200944 14.9479593,14.0779951 C15.0853256,13.7703589 15.1233655,13.4764424 15.043059,13.2875338 C15.0263392,13.0798285 14.8533268,12.9194058 14.6446969,12.9181593 L13,12.9181593 C13.1231013,12.4020905 14.0281337,12 15.1275921,12 C15.8197068,12 16.4404966,12.1609417 16.8288205,12.4068396 C16.8953903,12.4490538 16.9524501,12.4923234 17,12.5345376 L17,12.5345376 Z"
                              id="路径" fill="url(#linearGradient-4)" fill-rule="nonzero"></path>
                            <path
                              d="M11,16.4285 C10.8988376,16.467915 10.7964848,16.4979594 10.6933962,16.5185 C10.5336681,16.5538341 10.3727556,16.5715381 10.2116745,16.5715 C10.1432783,16.5715 10.0689858,16.5715 10,16.5625 C10.2329009,16.5535 10.4599057,16.5265 10.682783,16.4905 C10.7936321,16.4645 10.8991745,16.4465 11,16.4285 L11,16.4285 Z"
                              id="路径" fill="url(#linearGradient-6)" fill-rule="nonzero"></path>
                            <path
                              d="M18,12.9997448 C18,13.472508 17.3420042,13.8677442 16.4620339,13.9726338 C16.3071102,13.9910747 16.1512625,14.0002113 15.995293,14 C15.9378174,14 15.8843057,14 15.8268302,13.9949292 C15.9556547,13.7000222 15.9908336,13.417783 15.9155209,13.2363798 C15.8998407,13.0369267 15.7375867,12.8828776 15.5419299,12.8816807 L14,12.8816807 C14.1154466,12.3861153 14.9642017,12 15.995293,12 C16.6443701,12 17.2265577,12.1545475 17.5907345,12.3906757 C17.6487056,12.4271591 17.7022173,12.4682028 17.7468104,12.5087399 C17.7646476,12.5269815 17.7819893,12.5406628 17.7998266,12.5594112 C17.9241918,12.6952103 18,12.8451973 18,13.0002515 L18,12.9997448 Z"
                              id="路径" fill="url(#linearGradient-8)" fill-rule="nonzero"></path>
                            <path
                              d="M16.6035,13.567 C16.6395,13.603 16.6755,13.63 16.7105,13.666 C16.6655,13.648 16.6205,13.63 16.5765,13.603 C16.4625206,13.5351237 16.3646064,13.4433504 16.2895,13.334 C16.4008747,13.4021931 16.5059563,13.4801677 16.6035,13.567 L16.6035,13.567 Z"
                              id="路径" fill="url(#linearGradient-10)" fill-rule="nonzero"></path>
                            <path
                              d="M18,7.72172641 C18,8.4936357 17.8463339,9.20234089 17.5803432,9.7746891 C17.5179407,9.853109 17.4477379,9.93211412 17.3705148,10 C17.4687988,9.54352597 17.5171607,9.07651792 17.5171607,8.59839064 C17.5174896,7.71781093 17.3431947,6.84209425 17,6 C17.4336973,6.25749817 17.776131,6.68237015 17.9648986,7.19151426 C17.9929797,7.36474031 18,7.54323336 18,7.72172641 L18,7.72172641 Z"
                              id="路径" fill="url(#linearGradient-12)" fill-rule="nonzero"></path>
                            <path
                              d="M18.0189715,9.50024567 C17.9398666,9.46320136 18.1185441,9.1447232 18.3619438,8.27212393 C18.3619438,8.27212393 18.6440662,7.25700696 19.0611648,6.39881381 C19.0960152,6.32935573 19.1800987,6.15390977 19.3786908,6.0618135 C19.4185198,6.04329134 19.6121332,5.95119507 19.7659176,6.03403027 C19.9296592,6.11686546 19.9396165,6.33398627 19.9495737,6.44048865 C19.9625963,6.62313731 19.919628,6.80547358 19.8256612,6.96631204 C19.1850774,8.10645355 19.0611648,8.27212393 19.0611648,8.27212393 C18.3265402,9.3247997 18.0886723,9.53677547 18.0189715,9.50024567 L18.0189715,9.50024567 Z M22.6540765,6.87833181 C22.7879463,6.95242042 22.9516879,7.03988615 22.991517,7.2014405 C23.0905364,7.60275385 22.3017001,8.11983066 21.7208598,8.34569804 C21.6406139,8.37567346 21.5594463,8.40346848 21.4774601,8.42904774 C21.4083125,8.45220043 21.2993358,8.48924474 21.1599341,8.51651346 C20.8673013,8.58134101 20.6687093,8.56796389 20.6637306,8.61375478 C20.6543265,8.6646907 20.9021517,8.68269835 21.0564892,8.88129701 C21.0858079,8.92245735 21.1654659,9.0243292 21.15053,9.13957816 C21.1405728,9.22704389 21.0658933,9.35669897 20.5796471,9.54603655 C20.3087886,9.6556649 20.0259297,9.73760854 19.7360458,9.79042609 C19.0561861,9.91030559 18.2175635,10.0029164 18.2076062,9.94271936 C18.2026276,9.91493613 18.3613906,9.89229794 18.7884465,9.72148251 C18.9689896,9.65021992 19.144513,9.56842241 19.3139686,9.47657847 C19.4483916,9.40300436 19.5523897,9.33354628 19.6370264,9.27797981 C19.8107253,9.16273085 19.9147233,9.0845262 19.9445951,9.06137351 C20.0237,9.00117651 20.1326767,8.90908024 20.222292,8.7845702 C20.2665465,8.71974266 20.2820356,8.68732889 20.2870142,8.65491512 C20.3069288,8.57259443 20.2720784,8.53503562 20.2919929,8.47998366 C20.3213115,8.41052558 20.4059482,8.38274235 20.4457772,8.36885073 C20.7483673,8.26749339 21.1649128,8.04574204 21.3435903,7.93512362 C21.5322251,7.81987466 21.6710735,7.72726388 21.7258385,7.55696296 C21.7806034,7.38614754 21.745753,7.14587404 21.6218404,7.10008315 C21.5820114,7.08619154 21.5172892,7.08619154 21.4879706,7.04451669 C21.4630774,7.00747238 21.4824387,6.961167 21.4879706,6.94778988 C21.5471609,6.79549661 22.1722557,6.62005065 22.6540765,6.87833181 L22.6540765,6.87833181 Z M21.944345,10.3862221 C21.8547297,10.1691012 21.5172892,10.1135348 21.2744426,10.077005 C21.0459788,10.0399607 20.8722799,10.0538523 20.6045402,10.077005 C20.2870142,10.1047882 20.0237,10.1552096 19.8157039,10.201515 C19.1800987,10.3445472 18.7784892,10.4320129 18.7784892,10.5431459 C18.7784892,10.6491337 19.348819,10.737114 20.4950104,10.9074149 C21.2639322,11.0231784 21.6013727,11.0550776 21.8104752,10.8569935 C21.9343878,10.7319689 22.008514,10.5380008 21.944345,10.3862221 L21.944345,10.3862221 Z M21.3834193,10.5981978 C21.3236758,10.7185918 21.0459788,10.7093307 20.5005422,10.6676559 C19.7260885,10.6028284 19.3344363,10.5709291 19.3344363,10.5153626 C19.3344363,10.4742023 19.5822614,10.441274 20.0784649,10.3676999 C20.0884222,10.3676999 20.2919929,10.3352861 20.5652644,10.316764 C20.7135169,10.3075029 20.8274722,10.3028724 20.9618953,10.3121334 C21.2744426,10.3352861 21.333633,10.4093747 21.3491221,10.4320129 C21.3834193,10.4736878 21.4132911,10.5431459 21.3834193,10.5981978 L21.3834193,10.5981978 Z"
                              id="形状" fill="#FFFFFF" fill-rule="nonzero"></path>
                            <path
                              d="M17.9871778,7.60945632 C17.9750233,7.46082724 17.9579179,7.31263034 17.9358891,7.16510457 L17.9358891,7.16089934 C17.914785,6.80426862 17.8663666,6.44971247 17.7910461,6.100249 C17.3864353,4.2312616 16.312697,3.02389575 15.9422786,2.61739099 C14.3361827,0.853066891 12.3420973,0.312929534 11.5713422,0.140515447 C10.9492293,0.0316469313 7.12394761,-0.576241218 3.74981644,1.98473876 C3.10300903,2.47534795 0.0912229721,4.89335039 0.00194265382,8.82897059 C-0.0916117222,13.0369957 3.20986047,16.3694002 6.4472218,17.4926617 C8.99456024,18.3766927 11.4526184,17.8571142 11.8705262,17.7608613 C12.3430471,17.6519928 13.8342183,17.2786626 15.2270863,16.3021167 C15.4515982,16.1477883 15.6650167,15.9783982 15.8658205,15.7951539 C16.1555066,15.5269542 17.0031947,14.7345035 17.3826361,13.4519109 C17.4457972,13.2416498 17.4795147,13.0603581 17.5013599,12.9449481 L17.5061089,12.9197168 C17.1938549,12.9031371 16.8809195,12.9031371 16.5686655,12.9197168 C16.5515693,12.9197168 16.534948,12.9197168 16.5135777,12.9155115 C16.4832094,12.9105129 16.4532218,12.903488 16.4238225,12.8944854 C16.4067262,12.8776645 16.3901049,12.8608436 16.3730087,12.8486952 C16.3267163,12.8079477 16.2768117,12.7713566 16.2238915,12.7393595 C15.8700945,12.5216224 15.3168415,12.3791121 14.6947286,12.3791121 C13.7059966,12.3791121 12.8925009,12.7351542 12.7818503,13.1921217 L14.2597245,13.1921217 C14.2981911,13.1921217 14.4131157,13.2047373 14.5028709,13.2883745 C14.5380132,13.3196801 14.5584337,13.3537891 14.5693563,13.3715445 C14.5949657,13.4172541 14.6114103,13.4673794 14.6177956,13.5191945 C14.6605362,13.8584157 14.5836031,14.1060565 14.5323144,14.2191302 C14.4672538,14.3597715 14.3898459,14.4737798 14.3461555,14.5382598 L14.3409316,14.546203 C14.2526108,14.66569 14.1527329,14.7764777 14.0426974,14.8770138 C13.9344213,14.9798081 13.8413418,15.0498951 13.7582351,15.1125062 L13.7249924,15.1377375 L13.7145447,15.1452135 C13.6140079,15.21956 13.5102238,15.2895578 13.4034883,15.3550073 C13.163113,15.4944319 12.9039614,15.5998206 12.633683,15.6680627 C12.6381891,15.6252106 12.6407245,15.58218 12.6412813,15.5391026 C12.6412813,15.3022084 12.5852437,15.0812007 12.4878901,14.890564 C12.4507452,14.8165242 12.4065399,14.7461213 12.3558692,14.6803029 C12.2874843,15.3634178 11.6444761,15.9292537 10.7882398,16.1175542 C10.7027587,16.1301698 10.6177524,16.1385803 10.5327461,16.1469907 C10.3494366,16.1638116 10.166127,16.1764273 9.98281738,16.1806325 C9.889263,16.1848377 9.79570863,16.1848377 9.70262915,16.1848377 L9.70167936,16.1848377 C5.28040402,16.1848377 1.69731891,12.8440228 1.69731891,8.7243073 C1.69731891,4.60412459 5.27992913,1.26377687 9.70167936,1.26377687 C12.8027457,1.26377687 15.4906532,2.90661679 16.8203601,5.31247081 C16.8211706,5.31401886 16.8219621,5.31557647 16.8227345,5.31714328 L16.8203601,5.31714328 C17.0565768,5.74383904 17.2478455,6.19317373 17.3911842,6.65814174 C17.6001266,7.33047656 17.70624,8.02965582 17.7060398,8.73271774 L17.7060398,8.75608009 C17.7051791,9.12164059 17.6753284,9.48657774 17.6167595,9.84756872 L17.6177093,9.84663423 L17.6167595,9.8513067 C17.6637741,9.79710606 17.7060398,9.73449499 17.7449812,9.67141666 C17.9050209,9.21818722 17.9985753,8.65842549 18,8.04866836 L18,8.02857674 C18,7.88878309 17.9958008,7.74901993 17.9876527,7.60945632 L17.9871778,7.60945632 Z"
                              id="路径" fill="#FFFFFF"></path>
                            <path
                              d="M7.2411475,6.03145727 C7.23707259,6.01065225 7.23385003,5.98968142 7.23148829,5.96859992 L7.34160327,6.16806062 C7.34086001,6.14001938 7.34037703,6.11197153 7.34015439,6.08392087 L7.23197125,5.96859992 L7.10640154,4.27244155 C7.08666136,3.97102009 7.18464392,3.67391864 7.37876938,3.44657131 C7.57289485,3.21922398 7.84724113,3.08027769 8.14138576,3.06033421 L8.98656652,3.0029212 C9.08170973,2.99599205 9.17540405,3.00143638 9.26571766,3.01875927 C9.44120638,3.00983033 9.61710888,3.02229109 9.78972973,3.05587975 C10.2475772,3.14607649 10.6652543,3.38402903 10.9816761,3.73493703 C12.8712229,3.62013522 14.5899483,4.85146614 15.133687,6.70952466 L15.2336598,7.38462242 L15.2351087,7.39501616 L15.2380064,7.39353134 L15.2602226,7.53755879 L15.2640863,7.54894241 L15.3027231,7.80631105 L15.6668753,10.2171624 L15.6755686,10.2864539 L15.7142054,10.5368934 L15.731592,10.6655777 L15.731592,10.6923045 L15.732075,10.7155666 C15.7794764,11.0633302 16.0694426,11.3222886 16.4120833,11.3228577 C16.6685353,11.3228577 16.8882823,11.1763555 17.0080564,10.9645213 L17.013852,10.9496731 L17.062148,10.8343522 L17.1394217,10.6477599 C17.1470207,10.62905 17.1583745,10.612187 17.1727459,10.5982659 C17.2147444,10.5540014 17.2787576,10.5402937 17.3345377,10.5636202 L17.3823508,10.5858924 L17.3823508,10.5903469 L17.6059615,10.6858703 L17.9237494,10.8209888 C17.9261642,10.8234635 17.928579,10.8244534 17.9305109,10.8259382 C17.9328043,10.8268905 17.9349263,10.8282288 17.9367894,10.8298977 L17.941136,10.8348471 C17.9932957,10.8744423 18.015029,10.9452187 17.9889491,11.0075811 L17.8913911,11.246142 L17.8889763,11.2560408 L17.8889763,11.2609902 C17.8546861,11.3896745 17.806873,11.5094499 17.7416733,11.6247709 C17.7397415,11.6267506 17.7387756,11.6292253 17.7378097,11.6312051 C17.7363608,11.6336798 17.7353949,11.6361545 17.7329801,11.6381343 C17.7306452,11.6417103 17.7283908,11.6453408 17.7262186,11.6490229 L17.7238038,11.6529825 L17.7223549,11.6559521 L17.7117298,11.6737699 C17.7117298,11.6757497 17.7102809,11.6767396 17.709315,11.6777294 C17.7083491,11.6792143 17.7073832,11.6802041 17.7073832,11.6826788 C17.4127773,12.157821 16.8708957,12.4904204 16.3212867,12.4904204 L15.9527879,12.4904204 C15.2910548,12.4884592 14.7089605,12.0418144 14.5208102,11.3916543 L14.5145317,11.3669073 C14.5101766,11.3530735 14.5064697,11.3390342 14.5034236,11.3248374 L14.5000429,11.3099892 L14.499077,11.3099892 L14.5101851,11.3629478 C14.5058394,11.348944 14.5021327,11.3347403 14.499077,11.320383 L14.4966622,11.3094943 L14.4927985,11.3094943 C14.4849299,11.2802626 14.4791194,11.2504897 14.4754119,11.2204051 L14.388479,10.8298977 L14.3841324,10.8120799 C14.3764587,10.7875304 14.3708044,10.7623656 14.3672288,10.7368491 L14.3498422,10.6527093 L14.3498422,10.6833956 L14.3498422,10.6824057 L14.3498422,10.7012134 C14.3463195,10.6908877 14.3454871,10.6797987 14.3474274,10.6690423 L14.3479103,10.6670626 L14.3474274,10.6621132 C14.3463866,10.6573937 14.3457403,10.6525919 14.3454955,10.6477599 C14.3454955,10.6398409 14.3454955,10.630437 14.3445296,10.6210332 L14.3411489,10.6037103 L14.3363193,10.581438 L14.3363193,10.5680746 L14.3348704,10.5586708 L14.3324556,10.5621353 L14.327626,10.5680746 L14.3266601,10.5690645 L14.3256942,10.5700544 L14.3232794,10.5715392 C14.3208646,10.573024 14.3194157,10.5740139 14.3194157,10.5764886 L14.3126542,10.5413479 L14.3107224,10.5289744 L14.3063757,10.5057122 C14.2434055,10.213254 14.0671659,9.95957679 13.8181027,9.80289783 C13.6531921,9.70486205 13.4659039,9.65329269 13.2752552,9.65342604 C13.2404821,9.65342604 13.2057089,9.65342604 13.1714187,9.65788049 C13.1540321,9.65788049 13.1366456,9.65788049 13.119259,9.66233495 C13.0681633,9.67162677 13.0175508,9.68352005 12.9676094,9.69797061 L12.9289726,9.71133398 C12.9028927,9.7202429 12.8806765,9.72865687 12.8594263,9.73756579 C12.8500888,9.74029103 12.8410312,9.74393765 12.8323805,9.74845446 C12.8173522,9.75558922 12.8025348,9.76318167 12.7879481,9.77122169 L12.7599364,9.78656482 L12.7425498,9.79794843 L12.7251633,9.8088371 L12.6865264,9.83556385 C12.6816968,9.83556385 12.6773502,9.84001831 12.6730035,9.84447276 C12.6599638,9.84920392 12.6480943,9.85680637 12.6382304,9.86674505 C12.6315211,9.87149228 12.6250718,9.8766144 12.618912,9.88208818 L12.5995936,9.89743131 C12.5856949,9.90642465 12.5727463,9.91687457 12.5609567,9.92861251 C12.5474338,9.93752143 12.5343939,9.9508848 12.5257006,9.95979372 L12.4952741,9.99097492 L12.484649,10.0043383 C12.481425,10.0090485 12.4778741,10.0135145 12.4740238,10.0177017 C12.4740238,10.0221561 12.4691942,10.0266106 12.4653306,10.031065 C12.4585381,10.0374245 12.4526816,10.04476 12.447944,10.0528424 C12.4432243,10.057787 12.4388659,10.0630806 12.4349041,10.0686805 C12.4308322,10.0740334 12.4264791,10.0791554 12.4218641,10.0840236 C12.4121329,10.0950659 12.4034036,10.1069938 12.3957843,10.1196592 C12.3846817,10.132756 12.374968,10.1470244 12.3668066,10.1622241 C12.3634024,10.1709674 12.3584951,10.1790139 12.3523178,10.1859812 C12.3469114,10.2002089 12.3397713,10.2136791 12.3310676,10.2260713 C12.326238,10.2330004 12.3233402,10.2394346 12.3199595,10.2458689 C12.3170849,10.2528217 12.3135247,10.2594553 12.3093343,10.2656665 C12.3091094,10.2681472 12.308279,10.2705301 12.3069195,10.2725956 C12.3059536,10.2750703 12.3049877,10.277545 12.3049877,10.2795248 C12.3024944,10.2863028 12.299591,10.2929148 12.2962944,10.2993224 C12.2929137,10.3062515 12.289533,10.3126857 12.2876011,10.3191199 C12.2852891,10.3275729 12.2823838,10.3358434 12.2789078,10.3438669 C12.2753557,10.3518589 12.2724483,10.3601356 12.2702145,10.3686139 L12.2702145,10.3725734 L12.2639361,10.3948457 L12.2571746,10.417118 L12.2571746,10.4215725 L12.2508961,10.4463194 C12.2484813,10.4537435 12.2460665,10.4611676 12.2441347,10.4705715 C12.239265,10.486587 12.234916,10.502764 12.2310947,10.5190756 L12.2310947,10.524025 C12.2292061,10.5320197 12.2277549,10.5401163 12.2267481,10.548277 C12.2257822,10.5557011 12.2248163,10.5631252 12.2224015,10.5725291 C12.2180548,10.5903469 12.2137082,10.6081647 12.2137082,10.6259826 C12.2135771,10.6347582 12.212932,10.6435179 12.2117763,10.6522144 C12.2104157,10.6610613 12.2096091,10.6699885 12.2093615,10.6789411 C12.2089651,10.6805747 12.2086427,10.6822263 12.2083956,10.6838905 L12.2074297,10.68785 L12.2064638,10.6923045 C12.2050149,10.7012134 12.2050149,10.7101223 12.2050149,10.7190312 L12.2050149,12.6280137 L12.1924579,12.6280137 L12.1924579,13.3159799 C12.1906088,13.6904985 11.8948072,13.9936371 11.5293532,13.9955321 L9.83995762,13.9955321 C9.47447258,13.9941766 9.17844192,13.6910242 9.17685294,13.3164748 L9.17685294,12.4562696 C9.10295662,11.8791784 8.60515517,11.4596038 8.0383574,11.4966825 C7.47155962,11.5337613 7.02985674,12.0147963 7.02816195,12.5968325 L7.02816195,12.6280137 L7.01512201,12.6280137 L7.01512201,13.3209293 C7.01576671,13.5012282 6.94616202,13.6743332 6.82175632,13.8018246 C6.69735061,13.9293161 6.52843535,14.0006472 6.35250029,14 L4.66262172,14 C4.29713774,13.9983581 4.0013227,13.6949848 4,13.3204343 L4,9.10750754 C4,9.07781116 4.00193184,9.04811478 4.00531256,9.01940827 C4.04733012,7.56280072 5.12819558,6.36851121 6.51284316,6.181424 C6.51284316,6.2126052 6.5171898,6.24824086 6.52153645,6.27942206 C6.56162216,6.51105384 6.6186115,6.73229189 6.67608379,6.95451982 C6.71085694,7.08963836 6.74563009,7.2247569 6.77702252,7.36235014 C6.8407733,7.64199107 6.92480841,7.87956213 7.01705386,8.14138523 L7.07983871,8.32154329 C7.19574922,8.66057699 7.31793821,8.9050772 7.43481464,9.13868874 L7.47876404,9.22728295 C7.56414935,9.41098233 7.66261752,9.58798936 7.7733699,9.75686844 L7.78302911,9.77171663 L7.79944977,9.79547373 L7.80379641,9.79992819 C7.83422292,9.84892722 7.86851311,9.89297685 7.90328626,9.93752143 L7.92743428,9.96820769 C7.94578678,9.98899516 7.9651052,10.0097826 7.98538953,10.031065 C8.12448214,10.1686583 8.3886615,10.3993002 8.79579715,10.5279845 C8.94358304,10.5745088 9.09088598,10.5804481 9.23867187,10.5665898 L10.8218162,9.77419133 L9.20389872,8.05922524 C9.09957927,8.38984497 8.9392364,8.62345651 8.7378419,8.7080912 L9.29807601,9.72766699 C9.22474698,9.77063457 9.14096655,9.79124061 9.05659579,9.78705976 C8.96107579,9.77988604 8.86848872,9.75006548 8.78613794,9.69995037 L8.77841057,9.70242507 C8.75233071,9.6890617 8.72625085,9.67569832 8.70451763,9.65788049 C8.59507804,9.58310045 8.49969608,9.48870592 8.42295169,9.37922944 C8.11433997,9.01198418 7.82552963,8.42251099 7.63089657,7.7196966 L7.62896473,7.71227251 C7.62506636,7.69792909 7.62120267,7.68357579 7.61737368,7.66921275 C7.61312182,7.65735881 7.6089361,7.64548006 7.60481671,7.6335771 C7.60173413,7.63063334 7.59867528,7.6276636 7.59564046,7.62466818 C7.59174273,7.60784846 7.58787904,7.59102047 7.58404941,7.57418433 C7.50702363,7.34452426 7.44839131,7.10881255 7.40873477,6.86939019 C7.33194406,6.59964805 7.28654578,6.32644133 7.24452822,6.05273967 L7.2411475,6.03145727 L7.2411475,6.03145727 Z M12.8468693,7.19654533 C12.7827737,7.0872276 12.7496607,6.96177322 12.7512431,6.83424947 C12.7500267,6.49467339 12.9847926,6.20227753 13.3101812,6.13810413 C13.6355698,6.07393073 13.9594629,6.25614743 14.0813162,6.57193143 C14.1156064,6.65656612 14.132993,6.74516032 14.132993,6.84315838 L14.132993,6.87136995 C14.0065001,6.66209231 13.7839901,6.53405958 13.5437812,6.53233625 C13.350597,6.53233625 13.1772142,6.61251648 13.0521275,6.7412008 C12.9323075,6.86255612 12.8595433,7.02435678 12.8473523,7.19654533 L12.8468693,7.19654533 Z"
                              id="形状" fill="url(#linearGradient-14)"></path>
                          </g>
                        </g>
                      </g>
                    </g>
                  </g>
                </g>
              </svg>
            </div>
            <!--输入框-->
            <div style="flex:1;">
              <el-input
                resize="none"
                v-model="sendData"
                type="textarea"
                class="input-area"
                :autosize="{ minRows: 1, maxRows: 4}"
                @keydown.native="keydownfn"
                placeholder="请输入对话内容..."
                v-clear-emoij
              >
              </el-input>
            </div>
            <!--发送按钮-->
            <div
              :style="'width:60px;padding-top:2px;'+ (sendData=='' || isSend ? '' : 'cursor:pointer')"
            >
              <svg
                v-if="!isSend"
                width="20"
                height="20"
                viewBox="0 0 52 52"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
                @click="sendData=='' ? '' : handleSendData()"
              >
                <path
                  d="M48.1857 2.01674C47.8845 1.76668 47.5185 1.60736 47.1302 1.55736C46.742 1.50735 46.3475 1.56871 45.9928 1.73429L3.42639 21.7141V25.5802L21.3051 32.7316L32.7732 50.375H36.6401L48.858 4.12345C48.9571 3.74467 48.9465 3.34555 48.8275 2.97257C48.7084 2.59958 48.4859 2.2681 48.1857 2.01674ZM34.2526 46.6876L24.3953 31.522L39.564 14.9082L37.1639 12.7169L21.8765 29.4601L7.13545 23.5637L45.0633 5.76064L34.2526 46.6876Z"
                  :fill="sendData=='' ? '#aaaaaa' : '#2D9CDB'"
                />
              </svg>
            </div>
          </div>
        </div>

        <div :style="(isMobile ? '' : 'flex:0.25;') + 'display: flex;align-items: center'" v-show="!isShow || isMobile">
        </div>

        <!--flex布局-文件支持-->
        <div
          class="file-container"
          v-show="isShow && !isMobile"
          style="margin-top:40px;"
        >
          <div style="position: absolute;right: 20px;top: 50px;cursor: pointer;z-index: 20" @click="isShow = !isShow">
            <i class="el-icon-close" style="font-size: 20px;color: #606266"/>
          </div>
          <!--切换栏-->
          <el-tabs
            v-model="activeName"
            style="padding: 0px 10px;"
          >
            <el-tab-pane
              name="content"
              label="相关段落"
            ></el-tab-pane>
            <el-tab-pane
              name="citation"
              label="引用文献"
              :disabled="isNotPdf"
            ></el-tab-pane>
          </el-tabs>


          <!--支持内容-->
          <div
            v-show="activeName=='content'"
            style="flex: 1;overflow-y: auto;"
            align="center"
          >
            <el-card
              class="content-card"
              align="left"
              v-for="(item, index) in contentList"
              :key="index"
            >
              <div
                slot="header"
                style="font-size:18px;font-weight: 600;"
              >{{ item.originalFileName }}
              </div>
              <div class="card-text">
                {{ item.content }}
              </div>
            </el-card>
          </div>

          <!--pdf浏览-->
          <iframe
            v-if="activeName=='citation' && !isMobile"
            :src="iframeUrl"
            frameborder="0"
            width="100%"
            height="100%"
            style="flex: 1;"
          ></iframe>
        </div>

      </div>
    </div>
    <el-drawer
      title="设置"
      :visible.sync="drawerVal"
      align="left"
      size="32%">
      <el-form
        :model="overrides"
        label-width="120px"
        style="margin-top: 20px;width:80%;"
      >
        <el-form-item label="检索文档数量">
          <template slot="label">
            <el-tooltip :content="description.top" placement="top">
              <span>检索文档数量</span>
            </el-tooltip>
          </template>
          <el-input-number
            v-model="overrides.top"
            :min="1"
            :max="4"
            :step="1"
            controls-position="right"
          ></el-input-number>
        </el-form-item>
        <el-form-item>
          <template slot="label">
            <el-tooltip :content="description.prompt_template" placement="top">
              <span>提示词模板</span>
            </el-tooltip>
          </template>
          <el-input
            :resize="false"
            type="textarea"
            :autosize="{ minRows: 4, maxRows: 8}"
            v-model="overrides.prompt_template"
            placeholder="请输入提示词模板"
            v-clear-emoij
          ></el-input>
        </el-form-item>
        <el-form-item>
          <template slot="label">
            <el-tooltip :content="description.exclude_category" placement="top">
              <span>排除类别</span>
            </el-tooltip>
          </template>
          <el-input
            :resize="false"
            type="textarea"
            :autosize="{ minRows: 4, maxRows: 8}"
            v-model="overrides.exclude_category"
            placeholder="请输入排除类别"
            v-clear-emoij
          ></el-input>
        </el-form-item>
        <el-form-item>
          <template slot="label">
            <el-tooltip :content="description.semantic_ranker" placement="top">
              <span>语义排序器</span>
            </el-tooltip>
          </template>
          <el-switch v-model="overrides.semantic_ranker" active-text="开启"></el-switch>
        </el-form-item>
        <el-form-item>
          <template slot="label">
            <el-tooltip :content="description.semantic_captions" placement="top">
              <span>概要查询</span>
            </el-tooltip>
          </template>
          <el-switch v-model="overrides.semantic_captions" active-text="开启"></el-switch>
        </el-form-item>
      </el-form>
    </el-drawer>
    <el-drawer
      :visible.sync="isShow"
      v-if="isMobile"
      size="80%"
      class="drawer-setting"
      :withHeader="false"
      :modal="false"
      style="min-width:400px;"
    >
      <div
        class="file-container"
        style="margin-top:30px;"
      >
        <!--切换栏-->
        <el-tabs
          v-model="activeName"
          style="padding: 0px 10px;"
        >
          <el-tab-pane
            name="content"
            label="相关段落"
          ></el-tab-pane>
          <el-tab-pane
            name="citation"
            label="引用文献"
            :disabled="isNotPdf"
          ></el-tab-pane>
        </el-tabs>


        <!--支持内容-->
        <div
          v-show="activeName=='content'"
          style="flex: 1;overflow-y: auto;"
          align="center"
        >
          <el-card
            class="content-card"
            align="left"
            v-for="(item, index) in contentList"
            :key="index"
          >0
            <div
              slot="header"
              style="font-size:18px;font-weight: 600;"
            >{{ item.originalFileName }}
            </div>
            <div class="card-text">
              {{ item }}
            </div>
          </el-card>
        </div>

        <!--pdf浏览-->
        <iframe
          v-show="activeName=='citation'"
          :src="iframeUrl"
          frameborder="0"
          width="100%"
          height="100%"
          style="flex: 1;"
        ></iframe>
      </div>
    </el-drawer>
    <!-- 内容展示抽屉 -->

  </div>
</template>

<script>
import axios from "axios";
import {getToken} from '@/utils/auth'

export default {
  name: 'DataChat',
  data() {
    return {
      isMobile: false,

      activeIndex: -1,
      filesLimit: 5,
      uptimecount: 0,
      upload: {
        // 是否显示弹出层（用户导入）
        open: false,
        // 弹出层标题（用户导入）
        title: "",
        // 是否禁用上传
        isUploading: false,
        // 是否更新已经存在的用户数据
        updateSupport: 0,
        // 上传的地址
        url: process.env.VUE_APP_GPT_URL + `/datasetupload/`,
      },

      language: 'domestic' || 'Chinese' || 'English',
      //language: 'English' || 'Chinese' || 'domestic',

      baseUrl: process.env.VUE_APP_GPT_URL,
      //baseUrl: 'http://192.168.50.103:5000',
      isNotPdf: true,
      drawerVal: false,
      isError: false,
      isSend: false,
      sendData: ' ',
      activeName: 'content',
      iframeUrl: '',
      pageNum: 1,
      isShow: false,
      waitingText: '请稍候，小助手正在为您查询',

      uploading: false,
      uploadProcess: '0',

      total_tokens: 0,
      systemMsg: '你是一个喜欢使用中文的助手',

      message: [],
      max_token_max: 4096,
      max_tokens: 4096,
      temperature: 1,
      top_p: 1,
      frequency_penalty: 0,
      presence_penalty: 0,
      model: 'gpt-3.5-turbo',
      models: ['gpt-3.5-turbo'],
      stop: ["Human:", "AI:"],
      isSteps: false,
      response: '',
      lastText: '',

      context: '',
      textNum: 150,

      historyListOld: [],
      historyList: [],

      contentList: [],
      waitingAnTimer: null,

      scrollPosition: 0,

      overrides: {
        prompt_template: '',
        exclude_category: '',
        top: 2,
        semantic_ranker: true,
        semantic_captions: true,
        suggest_followup_questions: false
      },
      description: {
        prompt_template: '',
        exclude_category: '',
        top: '',
        semantic_ranker: '',
        semantic_captions: '',
      },
      messages: [],

      single: {
        user: null,
        bot: null,
      },

      fileList: [],
      maxLength: 0,
      uploadfilelist: [],
      fileListlength: 0,
      uploadText: '正在上传...',
      uploadState: 0,

      customColors: [
        {color: '#f56c6c', percentage: 20},
        {color: '#e6a23c', percentage: 40},
        {color: '#5cb87a', percentage: 60},
        {color: '#1989fa', percentage: 80},
        {color: '#6f7ad3', percentage: 100}
      ],

      processText: 'placeholder',
      isWaiting: false,
      token: '',
      hist: [],

      // 按钮条迁移，后期继续
      buttonBar: [
        {
          label: '语言',
          icon: 'el-icon-edit-outline',
          click: () => {
            this.switchLanguage();
          }
        },
        {
          label: '清除对话',
          icon: 'el-icon-delete',
          click: () => {
            this.clearDialog();
          }
        }
      ]
    };
  },
  mounted() {
    this.sendData = '';
    this.token = getToken();

    if (document.body.getBoundingClientRect().width - 1 < 992) {
      this.isMobile = true;
    }

    this.delayAn(); //加载动画
    const historyContent = this.$refs.historyContent;
    historyContent.addEventListener('scroll', () => {
      this.scrollPosition = historyContent.scrollTop;
    }); //滚动条监听
  },
  methods: {
    switchLanguage() {
      this.language = this.language === 'English' ? 'Chinese' : this.language === 'Chinese' ? 'domestic' : 'English';
    },
    clearDialog() {
      this.isError = false;
      this.isSend = false;
      this.isShow = false;
      this.sendData = '';
      this.messages = [];
      this.historyList = [];
      this.total_tokens = 0;
    },
    clearTable() {
      this.$confirm('此操作将清空存储库, 是否继续?', '警告', {
        confirmButtonText: '确定',
        cancelButtonText: '取消',
        type: 'warning'
      }).then(() => {
        this.isWaiting = true;
        axios.post(this.baseUrl + '/redisclear', '', {headers: {'Authorization': 'Bearer ' + getToken()}})
          .then(response => {
            if (response.data.status == 'success') {

              this.$alert('清除成功', '提示', {
                confirmButtonText: '确定',
                callback: action => {
                  let t = setTimeout(() => {
                    this.isWaiting = false;
                    clearTimeout(t);
                  }, 3 * 1000);
                }
              });
            } else {
              console.log(response.data.msg)
              let t = setTimeout(() => {
                this.isWaiting = false;
                clearTimeout(t);
              }, 10 * 1000);
            }
          }).catch(error => {
          this.$message.error(error);
          let t = setTimeout(() => {
            this.isWaiting = false;
            clearTimeout(t);
          }, 10 * 1000);
        });
      }).catch(() => {
      });
    },
    //加载动画
    delayAn() {
      let n = 1;
      this.waitingAnTimer = setInterval(() => {
        this.waitingText = this.waitingText + '.';
        if (n < 4) {
          n++;
        } else {
          n = 1;
          this.waitingText = '请稍候，小助手正在为您查询';
        }
      }, 300);
    },

    //打开侧边栏-查看文件
    openFile(data, url, page, name, index) {
      if (this.isShow && this.activeIndex === index && this.activeName === 'citation' && this.iframeUrl === url) {
        this.isShow = false;
        this.$nextTick(() => {
          this.$refs.historyContent.scrollTop = this.scrollPosition;
        });
        this.activeIndex = -1;
        this.iframeUrl = '';
        return;
      }
      this.activeIndex = index;

      this.pageNum = page;

      if (name.split('.').reverse()[0] === 'pdf') {
        this.iframeUrl = '/build/pdf/web/viewer.html?file=' + encodeURIComponent(url + '&deptId=' + this.$store.state.user.deptId + '&userId=' + this.$store.state.user.userId + '&token=Bear ' + this.token) + '#page=' + this.pageNum;
      } else {
        this.iframeUrl = url + '&deptId=' + this.$store.state.user.deptId + '&userId=' + this.$store.state.user.userId + '&token=Bear ' + this.token;
      }

      this.contentList = [];

      //data.contents.forEach(item => {
      //  this.contentList.push({
      //    name: item.name,
      //    content: item.content,
      //  });
      //});

      data.citation.forEach(item => {
        for (let i = 0; i < item.content.length; i++) {
          this.contentList.push({
            name: item.name,
            originalFileName: item.originalFileName,
            content: item.content[i],
          });
        }
      });
      this.activeName = 'citation';
      this.isShow = true;
      this.isNotPdf = false;
      this.$nextTick(() => {
        this.$refs.historyContent.scrollTop = this.scrollPosition;
      });

    },
    //过程
    showProcess(data, index) {
      if (this.isShow && this.activeIndex === index && this.activeName === 'process') {
        this.isShow = false;
        this.$nextTick(() => {
          this.$refs.historyContent.scrollTop = this.scrollPosition;
        });
        this.activeIndex = -1;
        return;
      }
      this.activeIndex = index;
      this.contentList = [];
      data.citation.forEach(item => {
        for (let i = 0; i < item.content.length; i++) {
          this.contentList.push({
            name: item.name,
            originalFileName: item.originalFileName,
            content: item.content[i],
          });
        }
      });
      this.activeName = 'process';
      this.isShow = true;
      this.isNotPdf = true;
      this.$nextTick(() => {
        this.$refs.historyContent.scrollTop = this.scrollPosition;
      });
    },
    //切换侧边栏
    changeIframeShowStatus(data, index) {
      if (this.isShow && this.activeIndex === index && this.activeName === 'content') {
        this.isShow = false;
        this.$nextTick(() => {
          this.$refs.historyContent.scrollTop = this.scrollPosition;
        });
        this.activeIndex = -1;
        return;
      }
      this.activeIndex = index;
      this.contentList = [];
      data.citation.forEach(item => {
        for (let i = 0; i < item.content.length; i++) {
          this.contentList.push({
            name: item.name,
            originalFileName: item.originalFileName,
            content: item.content[i],
          });
        }
      });
      this.activeName = 'content';
      this.isShow = true;
      this.isNotPdf = true;
      this.$nextTick(() => {
        this.$refs.historyContent.scrollTop = this.scrollPosition;
      });
    },
    //点击预设follow-up问题
    setFollowQuestion(question) {
      this.sendData = question;
    },
    //打开上传对话框
    handleImport() {
      this.upload.open = true;
    },
    submitFileForm() {
      this.$refs.uploadFileButton.submit();
    },

    handleChange(file, fileList) {
      this.uploadfilelist = [];
      for (let x of fileList) {
        this.uploadfilelist.push(x.raw)
      }
      //   this.fileList = fileList;
      this.fileListlength = fileList.length;
      console.log(this.fileListlength)
      //防抖
      let length = fileList.length
      this.maxLength = Math.max(length, this.maxLength)
      setTimeout(() => {
        console.log(this.maxLength, length)
        if (length === this.maxLength) {
          //上传文件，触发
          this.$refs.uploadFileButton.submit();
        }
      }, 100)
    },
    //点击确定
    handleSendData() {
      if (this.isSend) {
        return;
      }
      if (this.sendData === '') {
        return;
      }
      this.isSend = true;
      this.historyList.push({
        text: this.sendData,
        role: 'user',
      });

      // 创建单个对话
      this.single = {
        user: this.sendData,
        bot: undefined
      }

      let t = setTimeout(() => {
        this.historyList.push({
          role: 'gpt',
          text: '',
          citation: [],
          follow: [],
        });


        this.sendRequest();
        clearTimeout(t);
      }, 200);
      this.sendData = '';
    },
    //发送请求，处理返回数据
    sendRequest() {
      let his = JSON.parse(JSON.stringify(this.messages));
      his.push({user: this.single.user, bot: undefined});

      let data = {
        history: his,
        approach: 'rrr',
        overrides: this.overrides,
        language: this.language,// en or cn
        hist: this.hist,

        deptId: this.$store.state.user.deptId,
        userId: this.$store.state.user.userId,
        trainType: 'Robert',
      };

      let index = this.historyList.length - 1;

      this.$nextTick(() => {
        this.$refs.historyContent.scrollTop = this.$refs.historyContent.scrollHeight;
      });

      let requestUrl = '/chat';
      if (this.language === 'domestic') {
        requestUrl = '/chat_glm';
      }

      axios.post(this.baseUrl + requestUrl, data, {
        headers: {'Authorization': 'Bearer ' + getToken()},
        timeout: 3 * 60 * 1000
      }) //post请求，传递参数text
        .then(response => { //请求成功
          /*
            answer: string;
            thoughts: string | null;
            data_points: string[];
            error?: string;
          */
          if (response.data.error) {
            console.log(response.data.error);
            this.historyList[index].role = 'gpt';
            this.historyList[index].isError = true;
            this.historyList[index].errorText = response.data.error;
            this.isSend = false;
            return;
          }

          this.historyList[index].role = 'gpt';

          const text = response.data.answer;
          const regex = /\[([^\]]+.(pdf|xlsx))\]/g;
          const matches = text.match(regex);
          if (matches != null) {
            const result = [];
            let start = 0;
            matches.forEach(item => {
              const index = text.indexOf(item, start);
              const before = text.substring(start, index);
              const content = item.substr(1, item.length - 2);
              const pdf = content.split(",");
              result.push({text: before, pdf: [content]});
              start = index + item.length;
            })
            if (start < text.length) {
              const last = text.substr(start);
              result.push({text: last, pdf: []});
            }
            this.historyList[index].answers = result;

          } else {
            this.historyList[index].answers = [{
              text: text,
              pdf: [],
            }];
          }

          this.historyList[index].text = response.data.answer;
          let originalFileNames = response.data.originalFileNames;

          this.hist = response.data.hist;

          let tmp = response.data.data_points;
          let citation = [];
          tmp.forEach((item, index) => {
            let list = item.split(': ');
            if (matches != null && matches.indexOf('[' + list[0] + ']') != -1) {
              let data = {
                name: list[0],
                originalFileName: originalFileNames[index],
                url: this.baseUrl + '/contentfile?path=' + list[0],
                page: list[0].split('.')[0].split('_')[1],
                content: [list.slice(1).join(": ")],
              };
              citation.push(data);
            } else {
              let data = {
                name: list[0],
                url: '',
                originalFileName: originalFileNames[index],
                content: [list.slice(1).join(": ")],
              };
              citation.push(data);
            }
          });
          let n = 0;
          citation.forEach(item => {
            if (item.url === '') {
              n += 1;
            }
          });
          if (n === citation.length) {
            this.historyList[index].hasNoFiles = true;
          } else {
            this.historyList[index].hasNoFiles = false;
          }
          this.historyList[index].citation = citation;

          his[his.length - 1].bot = response.data.answer;
          this.messages = JSON.parse(JSON.stringify(his));
          this.isSend = false;
        })
        .catch(error => {
          console.log(error.response);
          this.historyList[index].role = 'gpt';
          this.historyList[index].isError = true;
          this.historyList[index].errorText = error.response.data.error || error;
          this.isSend = false;
        });
    },
    keydownfn(event) {
      if (event.keyCode == 13) {
        if (!event.shiftKey && !event.ctrlKey && !event.altKey && !event.metaKey) {
          event.preventDefault();
          this.handleSendData();
        } else if (!event.shiftKey) {
          this.sendData = this.sendData + '\n'
        }
      }
    },
    uploadFile(param) {
      //判断文件名是否只有A-Z,a-z,0-9,_, ,-
      let reg = /^[\u0020A-Za-z0-9_-]+$/;
      if (!reg.test(param.file.name.split('.')[0])) {
        this.$message.error('文件名只能包含字母、数字、下划线、中划线');
        this.$refs.uploadFileButton.clearFiles();
        this.maxLength = 0;
        return;
      }

      if (param.file.size > 1024 * 1024 * 40) {
        this.$message.error('文件大小不能超过40M');
        this.$refs.uploadFile.clearFiles();
        this.maxLength = 0;
        return;
      }

      this.uptimecount = this.uptimecount + 1;
      if (this.uptimecount == this.fileListlength) {
        const formData = new FormData()
        //    formData.append('file', param.file)
        //   formData.append('name', param.file.name);
        for (let i = 0; i < this.fileListlength; i++) {
          formData.append('file', this.uploadfilelist[i])
          formData.append('name', this.uploadfilelist[i].name);
        }
        this.uploading = true;
        this.uploadState = 0;
        let that = this;
        fetch(this.baseUrl + '/datasetupload', {method: 'post', body: formData})
          .then(response => {
            const reader = response.body.getReader();
            const decoder = new TextDecoder('utf-8');
            const stream = new ReadableStream({
              start(controller) {
                function push() {
                  reader.read().then(({done, value}) => {
                    if (done) {
                      controller.close();
                      return;
                    }
                    controller.enqueue(decoder.decode(value));
                    push();
                  });
                }

                push();
              }
            });
            const reader2 = stream.getReader();

            function read() {
              reader2.read().then(({done, value}) => {
                if (done) {
                  return;
                }
                if (value.startsWith('Proxy error')) {
                  console.log('error clear')
                  that.fileList = [];
                  that.uploadfilelist = [];
                  that.$refs.uploadFileButton.clearFiles();
                  that.uptimecount = 0;
                  that.fileListlength = 0;
                  that.maxLength = 0;
                  that.uploading = false;
                  return;
                }
                let valueString = value.split(';').reverse()[1];
                let num = 0;
                switch (valueString) {
                  case 'one':
                    num = 1;
                    break;
                  case 'two':
                    num = 2;
                    break;
                  case 'three':
                    num = 3;
                    break;
                  case 'four':
                    num = 4;
                    break;
                  case 'five':
                    num = 5;
                    break;
                }
                console.log(value, num)
                that.uploadState = Number(num) * 100 / 5;
                if (valueString == 'five') {
                  that.$alert('上传成功', '提示', {
                    confirmButtonText: '确定',
                    callback: action => {
                      console.log('five clear')
                      that.fileList = [];
                      that.uploadfilelist = [];
                      that.$refs.uploadFileButton.clearFiles();
                      that.uptimecount = 0;
                      that.fileListlength = 0;
                      that.maxLength = 0;
                      that.uploading = false;
                    }
                  });
                }
                read();
              });
            }

            read();
          })
          .catch(error => {
            console.error('请求出错', error);
            this.fileList = [];
            that.uploadfilelist = [];
            this.$refs.uploadFileButton.clearFiles();
            that.uptimecount = 0;
            that.fileListlength = 0;
            that.maxLength = 0;
            this.uploading = false;
          });
      }
    },
    handleFileSuccess() {
      this.$message({
        message: '上传成功',
        type: 'success'
      });
      this.isSend = false;
    },
    handleFileFail() {
      this.$message.error('上传失败');
      this.isSend = false;
    },
    retrySend(item, index) {
      this.sendData = this.historyList[index - 1].text;
      this.historyList.splice(index - 1, 2);
      this.handleSendData();
    },

    formatText(percentage) {
      switch (percentage) {
        case 0:
          this.uploadText = '正在进行预处理';
          return '等待中';
        case 20:
          this.uploadText = '正在上传至blob';
          return `${percentage}%`;
        case 40:
          this.uploadText = '正在更新索引';
          return `${percentage}%`;
        case 60:
          this.uploadText = '正在更新技能集';
          return `${percentage}%`;
        case 80:
          this.uploadText = '正在更新索引器';
          return `${percentage}%`;
        case 100:
          this.uploadText = '处理完成';
          return `${percentage}%`;
        default:
          return `${percentage}%`;
      }
    },
    handleExceed(files, fileList) {
      this.$message.warning(`当前限制选择 ${this.filesLimit} 个文件，本次选择了 ${files.length} 个文件，共选择了 ${files.length + fileList.length} 个文件`);
      this.fileList = [];
      this.maxLength = 0;
    },
  },
  //销毁定时器
  beforeDestroy() {
    clearInterval(this.waitingAnTimer);
    this.waitingAnTimer = null;
  }
};
</script>

<style lang="scss" scoped>
.back {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}

background {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  padding-top: 50px;
}

.title-background {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: flex;
  background-color: rgba(255, 255, 255, 0.5);
}

.button-background {
  position: absolute;
  top: 0px;
  left: 0;
  width: 100%;
  height: 100%;
  display: flex;
  background-color: rgba(255, 255, 255, 0.5);
  z-index: 1000;
}

.chat-background {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: flex;
  background-color: #ffffff40;
}

.dialog-content {
  flex: 1;
  width: 100%;
  position: relative;
  overflow: auto;
}

.title {
  font-size: 20px;
  font-weight: 600;
  color: #000;
  margin: 10px;
  margin-bottom: 30px;
}

.box-card {
  overflow: auto; //10.20日添加，但是无效
}

#el-container {
  margin-top: 10px;

  ::v-deep .el-tabs__item.is-disabled {
    color: #000 !important;
  }
}

.content-card {
  width: 96%;
  min-height: 40px;
  margin-bottom: 20px;
  box-shadow: 0 2px 4px #00000024, 0 0 2px #0000001f;
  border-radius: 10px;
}

.process-card {
  width: 96%;
  min-height: 40px;
  margin-bottom: 20px;
  box-shadow: 0 2px 4px #00000024, 0 0 2px #0000001f;
  border-radius: 10px;
  background-color: #ffffff80;
  border: 1px solid #ffffff;
  white-space: pre-wrap;
}

.card {
  width: max-content;
  max-width: 70%;
  min-width: 60px;
  min-height: 40px;
  box-shadow: 0 2px 4px #00000024, 0 0 2px #0000001f;
  border-radius: 10px;
  background-color: #ffffffc0;
  border: 1px solid #ffffff;
  transition: box-shadow 0.3s ease-in-out, background-color 0.3s ease-in-out;
}

.card:hover {
  background-color: #ffffffff;
  box-shadow: 0 4px 8px #00000035, 0 0 4px #00000030;
}

.card-text {
  width: 100%;
  font-size: 16px;
  padding-top: 6px;
  white-space: pre-wrap;
}

.file-tag-container {
  margin-top: 10px;
}


.file-container {
  flex: 1;
  display: flex;
  flex-direction: column;
}

.dialog-container {
  position: relative;
  width: 100%;
  height: 100%;
  padding: 10px;
  overflow-y: auto;
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
}

.fade-enter-active,
.fade-leave-active {
  transition: width 0.5s;
}

.fade-enter, .fade-leave-to /* .fade-leave-active below version 2.1.8 */
{
  width: 100%;
}

//右侧列表出现与消失的伸缩动画
.slide-enter-active,
.slide-leave-active {
  transition: all 0.5s;
}

.card-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

::v-deep .el-card__header {
  padding: 16px 14px;
}

.icons {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  font-size: 18px;
  margin-bottom: 4px;
  cursor: pointer;
}

.button-bar {
  width: 98%;
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: space-between;
  margin: 10px;
}

.button-box {
  cursor: pointer;
  display: flex;
  align-items: center;
  margin: 0 6px;
  padding: 10px 16px;
  border-radius: 10px;
  font-size: 14px;
  color: #606266;
  background-color: #d0d3f380;
  border: 1px solid #d0d3f3;
}

.input-bar {
  width: 98%;
  display: flex;
  align-items: center;
  background: #fff;
  border-radius: 10px;
  box-shadow: 0 2px 4px #00000024, 0 0 2px #0000001f;
  padding: 4px 0px;
  min-height: 60px;
  margin-bottom: 10px;
}

.clear-button-clear {
  margin-right: 12px;
  color: #ff6e74;
  cursor: pointer;
  transition: text-shadow 0.3s, color 0.3s;
  background-color: #FFFFFF80;
  padding: 6px 10px;
  border-radius: 6px;
  border: 1px solid #FFF;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04), 0 0 2px rgba(0, 0, 0, 0.02);
}

.clear-button-clear:hover {
  box-shadow: 0 2px 4px #00000024, 0 0 2px #0000001f;
  color: #ff1c27;
}

.clear-button {
  margin-right: 12px;
  color: #909399;
  cursor: pointer;
  transition: text-shadow 0.3s, color 0.3s;
  background-color: #FFFFFF80;
  padding: 6px 10px;
  border-radius: 6px;
  border: 1px solid #FFF;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04), 0 0 2px rgba(0, 0, 0, 0.02);
}

.clear-button:hover {
  box-shadow: 0 2px 4px #00000024, 0 0 2px #0000001f;
  color: #606266;
}

.loading-text {
  font-size: 28px;
  font-weight: 600;
  height: 60px;
  color: #FFF;
  text-shadow: #20202080 0 0 4px;
  position: absolute;
  left: 0;
  top: calc(50% + 140px);
  right: 0;
  margin: auto;
  text-align: center;
  display: flex;
  flex-direction: column;
  align-items: center;
}

.empty-logo {
  width: 240px;
  height: 240px;
  position: absolute;
  left: 0;
  top: 0;
  right: 0;
  bottom: 0;
  margin: auto;
  z-index: 1000;
  transition: transform 3s ease-in-out, text-shadow 3s;
}

.empty-logo:hover {
  transform: translateY(-1em) scale(1.25) rotate(-30deg);
  transition: transform 1.5s ease-in-out;
  text-shadow: 0 2px 4px #00000080;
}

.loading {
  width: 240px;
  height: 240px;
  position: absolute;
  left: 0;
  top: 0;
  right: 0;
  bottom: 0;
  margin: auto;
  z-index: 1000;
  animation: 4s loading ease-in-out infinite;
}

@keyframes loading {
  0% {
    transform: rotate(0deg);
  }
  30% {
    transform: rotate(180deg +10deg);
  }
  40% {
    transform: rotate(180deg - 8deg);
  }
  50% {
    transform: rotate(180deg);
  }
  80% {
    transform: rotate(360deg+10deg);
  }
  90% {
    transform: rotate(360deg - 8deg);
  }
  100% {
    transform: rotate(360deg);
  }
}

.input-bar ::v-deep .el-textarea__inner {
  border: 0px;
  border-radius: 10px;
  font-family: "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB",
  "Microsoft YaHei", 微软雅黑, Arial, sans-serif;
  font-size: 18px;
  line-height: 1.5em;
}

.drawer-setting ::v-deep .el-textarea__inner {
  font-family: "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB",
  "Microsoft YaHei", 微软雅黑, Arial, sans-serif;
  font-size: 18px;
}

.control-card {
  width: 80%;
  height: 100%;
  background-color: #ffffff40;
  border-radius: 10px;
  border: 1px solid #ffffff;
  box-shadow: 0 2px 4px #00000024, 0 0 2px #0000001f;
  position: relative;
}

.tabs {
  position: absolute;
  width: calc(100% - 20px);
  height: calc(100% - 12px);
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  margin: auto;

  flex: auto;
  display: flex;
  flex-direction: column;
}

.index-span {
  height: fit-content;
  font-size: 12px;
  border: 1px solid rgba(198, 209, 244, 0.91);
  padding: 4px 1px;
  margin: 2px 2px;
  border-radius: 4px;
  background-color: rgb(213, 216, 244);
  color: rgb(10, 103, 159);
  cursor: pointer;
}

::v-deep .el-tabs__content {
  flex-grow: 1;
  overflow-y: scroll;
}

.tabs ::v-deep .el-textarea__inner {
  border: 1px solid #ffffff;
  border-radius: 8px;
  font-family: "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB",
  "Microsoft YaHei", 微软雅黑, Arial, sans-serif;
  font-size: 14px;
  background-color: #ffffff80;
}

::v-deep .v-note-wrapper .v-note-panel .v-note-show .v-show-content,
.v-note-wrapper .v-note-panel .v-note-show .v-show-content-html {
  padding: 0px;
}

::v-deep .markdown-body p {
  margin-bottom: 0px;
}

::v-deep .type-select .el-input--medium .el-input__inner {
  height: 40px;
  border: none;
  width: 80px;
  padding: 0;
  text-align: center;
  color: #888888;
}

::v-deep .el-select .el-input .el-select__caret {
  display: none;
}

.logo-center {
  position: absolute;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  margin: auto;
}

.drawer-setting::v-deep .el-drawer {
  width: 40%;
  height: 70%;
  margin-top: 15vh;
  margin-right: 4%;
  background-color: #ffffffc0;
  border: 1px solid #FFF;
  box-shadow: 0 2px 4px #00000024, 0 0 2px #0000001f;
  border-radius: 10px;
  padding: 12px;
}
</style>
<style scoped>

:root {
  font-size: 15px;
}

.color-background {
  font-family: "Quicksand", sans-serif;
  margin: 0;
  min-height: 100vh;
  background-color: #ffffff;
  background-image: radial-gradient(
    closest-side,
    rgb(58, 174, 211),
    rgba(243, 11, 164, 0)
  ),
  radial-gradient(closest-side, #b0e0edff, #b0e0ed00),
  radial-gradient(closest-side, #ccdcad, #ccdcad00);
  background-size: 80vmax 80vmax, 70vmax 70vmax, 80vmax 80vmax;
  background-position: -20vmax -20vmax, 40vmax -10vmax, 0vmax 0vmax;
  background-repeat: no-repeat;
  animation: 10s movement linear infinite;
}

@keyframes movement {
  0%,
  100% {
    background-position: -50vmax -50vmax, 60vmax -30vmax, 10vmax 10vmax;
  }
  25% {
    background-position: -40vmax -40vmax, 50vmax -40vmax, 0vmax -20vmax;
  }
  50% {
    background-position: -40vmax -60vmax, 40vmax -30vmax, 10vmax 0vmax;
  }
  75% {
    background-position: -40vmax -30vmax, 50vmax -30vmax, 20vmax 0vmax;
  }
}
</style>
